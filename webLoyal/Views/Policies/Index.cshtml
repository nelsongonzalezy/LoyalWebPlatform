@model List<core.Service.CertificadosModel>
<div class="">


    <div class="container">

        <div class="">
            <div class="d-md-flex align-items-center justify-content-between mb-4">
                <div>
                    <ol class="breadcrumb fs-sm mb-1">
                        <li class="breadcrumb-item active"><a href="../menu/index">@webLoyal.Resources.language.Resources.Menu</a></li>
                        <li class="breadcrumb-item"><a href="../Policies/index">Polizas</a></li>

                    </ol>
                </div>
                <nav class="nav nav-icon nav-icon-lg">

                    <a href="javascript:void(0);" class="nav-link" title="Refrescar" onclick="showSweetAlert()"><i class="ri-refresh-line"></i></a>

                </nav>
            </div>
            <div class="row g-3">

                <div class="col-xl-8">
                    @await Component.InvokeAsync("PoliciesStatus")
                    <br />
                    <div class="row g-3">
                        <div class="col-xl-12">
                            <div class="card card-one mt-3">
                                <div class="card-body p-3">
                                    <div class="table-responsive">
                                        <table class="table table-borderless mb-0 dataTable-loading searchable">
                                            <thead>
                                                <tr>
                                                    <th>CodigoSolicitud</th>
                                                    <th>NumeroPoliza</th>
                                                    <th>TipoVenta</th>
                                                    <th>NombreCompleto</th>
                                                    <td>EstadoCertificado</td>
                                                    <td>NumeroAsegurados</td>
                                                    <td>Poliza</td>
                                                    <td>Pais</td>
           
                                                    <td>FechaInicioVigencia</td>
                                                    <td>FormaPago</td>
                                                    <td>Prima</td>
                                                    <td>PrimaComisionable</td>
                                                    <td>Descripcion detallada del Plan</td>
                                                    <td>MotivoCancelacion</td>
                                                    <td>NumeroCuota</td>
                                                    <td>EstadoCuota</td>
                                                    <td>NombreAgencia</td>
                                                    <td>NombreAgente</td>


                                
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in Model)
                                                {
                                                    <tr>
                                                        <td> <a class="btn btn-outline-tertiary"> @item.CodigoSolicitud</a> </td>
                                                        <td><a class="btn btn-link">@item.NumeroPoliza</a></td>
                               
                                                        @switch (item.DescripcionTipoVenta)
                                                        {
                                                   
                                                            case "Renovaciones":
                                                                <td> <span class="badge bg-primary"> @item.DescripcionTipoVenta</span> </td>
                                                            break;
                                                            case "Nuevo Negocio":
                                                                <td> <span class="badge bg-info"> @item.DescripcionTipoVenta</span> </td>
                                                                break;
                                                            default:
                                                                <td> <span class="badge bg-info"> @item.DescripcionTipoVenta</span> </td>
                                                                break;
                                                        }



                                                        <td>@item.NombreCompleto</td>
                                                        @switch (item.CodigoEstadoCertificado)
                                                        {
                                                            case "01":
                                                                <td> <span class="badge bg-warning"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "02":
                                                                <td> <span class="badge bg-info"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "03":
                                                                <td> <span class="badge text-bg-success"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "04":
                                                                <td> <span class="badge bg-danger"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "05":
                                                                <td> <span class="badge bg-info"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "06":
                                                                <td> <span class="badge bg-danger"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "07":
                                                                <td> <span class="badge bg-info"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "08":
                                                                <td> <span class="badge bg-warning"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            case "09":
                                                                <td> <span class="badge bg-warning"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                            default:
                                                                <td> <span class="badge bg-info"> @item.DescripcionEstadoCertificado</span> </td>
                                                                break;
                                                        }

                                                        <td>@item.NumeroAsegurados</td>
                                                        <td>@item.DescripcionPoliza</td>
                                                        <td>@item.DescripcionPais</td>
    
                                                        <td>@item.FechaInicioVigencia</td>
                                                        <td>@item.DescripcionFormaPago</td>
                                                        <td>
                                                            @item.Prima.ToString("###.##")</td>
                                                        <td>@item.PrimaComisionable.ToString("###.##")</td>
                                                        <td>@item.DescripcionPlan</td>
                                                        <td>@item.DescripcionMotivoCancelacion</td>
                                                        <td>@item.NumeroCuota</td>
                                                        <td>@item.DescripcionEstadoCuota</td>
                                                        <td><a class="btn btn-link">@item.NombreAgencia</a></td>
                                                        <td><a class="btn btn-link">@item.NombreAgente</a></td>




                                                    </tr>

                                                }

                                                @*<tr>
                                                <td>9</td>
                                                <td>Nelson Gonnzalez</td>
                                                <td>Legacy</td>

                                                <td>2023-01-01</td>
                                                <td>
                                                <span class="badge bg-success" title="aprobado"><i class="ri-checkbox-circle-line"></i>&nbsp Aprobado</span>
                                                </td>

                                                <td>Venezuela</td>
                                                <td>Opcion II </td>
                                                <td>Trimestral</td>
                                                <td>
                                                <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
                                                <div class="btn-group me-2" role="group" aria-label="First group">
                                                <a href="../requestmonitor/detail" class="btn btn-sm btn-outline-primary"><i class="ri-pencil-fill"></i></a>

                                                </div>
                                                </div>

                                                </td>

                                                </tr>
                                                <tr>
                                                <td>8</td>
                                                <td>Nelson Gonnzalez</td>
                                                <td>Legacy</td>

                                                <td>2023-01-01</td>
                                                <td>
                                                <span class="badge bg-danger" title="Negado"><i class="ri-close-circle-line"></i>&nbsp Negado</span>
                                                </td>

                                                <td>Venezuela</td>
                                                <td>Opcion II </td>
                                                <td>Trimestral</td>
                                                <td>
                                                <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
                                                <div class="btn-group me-2" role="group" aria-label="First group">
                                                <a href="../requestmonitor/detail" class="btn btn-sm btn-outline-primary"><i class="ri-pencil-fill"></i></a>

                                                </div>
                                                </div>

                                                </td>

                                                </tr>
                                                <tr>
                                                <td>7</td>
                                                <td>Nelson Gonnzalez</td>
                                                <td>Legacy</td>

                                                <td>2023-01-01</td>
                                                <td>
                                                <span class="badge bg-warning"><i class="ri-error-warning-line" title="Evaluación Pospuesta">&nbsp Evaluación Pospuesta</i> </span>
                                                </td>

                                                <td>Venezuela</td>
                                                <td>Opcion II </td>
                                                <td>Trimestral</td>
                                                <td>
                                                <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
                                                <div class="btn-group me-2" role="group" aria-label="First group">
                                                <a href="../requestmonitor/detail" class="btn btn-sm btn-outline-primary"><i class="ri-pencil-fill"></i></a>

                                                </div>
                                                </div>

                                                </td>

                                                </tr>
                                                *@
                                            </tbody>
                                        </table>
                                    </div>
                                </div><!-- card-body -->
                            </div>
                        </div><!-- col -->
                    </div><!-- col -->

                </div><!-- col -->
                <div class="col-xl-4">
                    @await Component.InvokeAsync("PoliciesProduct")
                </div><!-- col -->
            </div><!-- row -->

        </div>

    </div>

</div>


@section Scripts{
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            startInterval();
        });

        // Función para mostrar un mensaje con un temporizador de cierre automático
        function showSweetAlert() {
            Swal.fire({
                position: 'top',
                text: 'Actualizando',

                timer: 2000, // 2 segundos
                timerProgressBar: true,
                showConfirmButton: false,
            }).then(() => {
                location.reload(); // Refrescar la página después de cerrar la alerta
            });
        }

        // Función para comenzar el intervalo de 1 minuto con conteo regresivo de 10 segundos
        function startInterval() {
            let countdown = 10;

            const interval = setInterval(() => {
                Swal.fire({
                    position: 'top',
                    text: 'Actualizando',

                    timer: 2000, // 2 segundos
                    timerProgressBar: true,
                    showConfirmButton: false,
                }).then(() => {
                    location.reload(); // Refrescar la página después de cerrar la alerta
                });

                countdown--;

                if (countdown < 0) {
                    clearInterval(interval);
                    showSweetAlert(); // Ejecutar la función después del conteo regresivo
                }
            }, 5000000); // 1 segundo
        }


        $("table").DataTable({
            searchPanes: {
                viewTotal: true
            },
            searchBuilder: true,
            sort: true,
            resizable: true,
            responsive: true,
            class: 'table table-borderless mb-0 dataTable-loading searchable dataTable-wrapper no-footer sortable fixed-columns table-striped',
            fixedColumns: true,
            order: [[0, "desc"]],
            dom: 'Bfrt<"col-md-6 inline"i> <"col-md-6 inline"p>',
            buttons: [
                {
                    extend: 'excelHtml5',
                    autoFilter: true,
                    className: 'btn btn-outline-primary',
                    filename: '@nameof(core.Service.PoliciesDetailModel)Excel',
                },
                {
                    extend: 'pdfHtml5',
                    className: 'btn btn-outline-primary',
                    filename: '@nameof(core.Service.PoliciesDetailModel)Pdf',
                }
            ]
        });

       



    </script>
}
